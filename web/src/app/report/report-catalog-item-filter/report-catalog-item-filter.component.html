<mat-slide-toggle [formControl]="include">{{include.value ? 'Tartalmazza' : 'Zárja ki'}} a kiválasztott elemeket</mat-slide-toggle>

<household-clearable-input type="text" label="Keresés" [formControl]="filter" />
<button mat-icon-button color="primary" (click)="markAll(true)"><mat-icon>done_all</mat-icon></button>
<button mat-icon-button color="warn" (click)="markAll(false)"><mat-icon>remove_done</mat-icon></button>

<mat-tree #tree [dataSource]="filteredItems" [childrenAccessor]="childrenAccessor" [formGroup]="selectionList">
  <ng-template #mark let-node>
    <ng-container *ngIf="node.children?.length > 0">
      <button mat-icon-button color="primary" (click)="markAll(true, node)"><mat-icon>done_all</mat-icon></button>
      <button mat-icon-button color="warn" (click)="markAll(false, node)"><mat-icon>remove_done</mat-icon></button>
    </ng-container>
  </ng-template>

  <ng-template #noCheck let-node>
    <div>
      {{node.name}}
      <ng-container *ngTemplateOutlet="mark; context: {$implicit: node}" />
    </div>
  </ng-template>

  <ng-template #check let-node>
    <div>
      <mat-checkbox [formControlName]="node.id">
        {{node.name}}
        <ng-container *ngTemplateOutlet="mark; context: {$implicit: node}" />
      </mat-checkbox>
    </div>
  </ng-template>

  <mat-nested-tree-node *matTreeNodeDef="let node">
    <ng-container *ngTemplateOutlet="node.id ? check : noCheck; context: {$implicit: node}" />
    <div role="group" *ngIf="node.children?.length > 0">
      <ng-container matTreeNodeOutlet />
    </div>
  </mat-nested-tree-node>
</mat-tree>